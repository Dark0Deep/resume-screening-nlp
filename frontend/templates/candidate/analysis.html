{% extends "base.html" %}

{% block title %}Resume Analysis{% endblock %}
{% block heading %}Resume Analysis Report{% endblock %}

{% block content %}

{% if resume %}

<!-- ================= SUMMARY ================= -->
<div class="card">
  <h3>{{ resume.filename }}</h3>
  <div class="ats-score-card">
    <div class="ats-label">ATS SCORE</div>
    <div class="ats-value">{{ resume.ats_score }}%</div>
    <div class="ats-subtext">
        Applicant Tracking System Compatibility
    </div>
  </div>

  <h4>Summary</h4>
  <p>
    {{ resume.summary if resume.summary else "No summary available." }}
  </p>
</div>

<!-- ================= PERSONAL DETAILS ================= -->
<div class="card">
  <h4>Personal Details</h4>

  {% if resume.personal_details %}
    <ul>
      {% if resume.personal_details.name %}
        <li><b>Name:</b> {{ resume.personal_details.name }}</li>
      {% endif %}
      {% if resume.personal_details.email %}
        <li><b>Email:</b> {{ resume.personal_details.email }}</li>
      {% endif %}
      {% if resume.personal_details.phone %}
        <li><b>Phone:</b> {{ resume.personal_details.phone }}</li>
      {% endif %}
      {% if resume.personal_details.location %}
        <li><b>Location:</b> {{ resume.personal_details.location }}</li>
      {% endif %}
    </ul>
  {% else %}
    <p>No personal details found.</p>
  {% endif %}
</div>

<!-- ================= SKILLS ================= -->
<div class="card">
  <h4>Skills</h4>

  {% if resume.skills and resume.skills|length > 0 %}
    <div class="skills-container">
      {% for skill in resume.skills %}
        <span class="skill-badge">{{ skill }}</span>
      {% endfor %}
    </div>
  {% else %}
    <p>No skills detected.</p>
  {% endif %}
</div>

<!-- ================= EXPERIENCE ================= -->
<div class="card">
  <h4>Experience</h4>

  {% if resume.experience and resume.experience|length > 0 %}
    <div class="timeline">
      {% for e in resume.experience %}
        <div class="timeline-item">
          <div class="timeline-dot"></div>
          <div class="timeline-content">
            <h5>{{ e.title }}</h5>
            {% if e.duration %}
              <div class="timeline-duration">{{ e.duration }}</div>
            {% endif %}

            {% if e.points %}
              <ul>
                {% for point in e.points %}
                  <li>{{ point }}</li>
                {% endfor %}
              </ul>
            {% endif %}
          </div>
        </div>
      {% endfor %}
    </div>
  {% else %}
    <p>No experience found.</p>
  {% endif %}
</div>

<!-- ================= PROJECTS ================= -->
<div class="card">
  <h4>Projects</h4>

  {% if resume.projects and resume.projects|length > 0 %}
    <div class="project-grid">
      {% for p in resume.projects %}
        <div class="project-card">
          <h5>{{ p.name }}</h5>

          {% if p.tech_stack and p.tech_stack|length > 0 %}
            <div class="tech-stack">
              {% for tech in p.tech_stack %}
                <span class="tech-badge">{{ tech }}</span>
              {% endfor %}
            </div>
          {% endif %}

          {% if p.points %}
            <ul>
              {% for point in p.points %}
                <li>{{ point }}</li>
              {% endfor %}
            </ul>
          {% endif %}
        </div>
      {% endfor %}
    </div>
  {% else %}
    <p>No projects mentioned.</p>
  {% endif %}
</div>

{% else %}

<div class="card">
  <p>No analysis found for this resume.</p>
</div>

{% endif %}

{% endblock %}