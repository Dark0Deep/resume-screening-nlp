{% extends "base.html" %}

{% block title %}Candidate Analysis{% endblock %}
{% block heading %}Candidate Resume Analysis{% endblock %}

{% block content %}

<div class="card analysis-card">

    <!-- ===== HEADER ===== -->
    <div class="analysis-header">
        <h3 class="resume-title">{{ resume.filename }}</h3>

        <div class="ats-score-card">
    <div class="ats-label">ATS SCORE</div>
    <div class="ats-value">{{ resume.ats_score }}%</div>
</div>


        <span class="ats-badge">
            ATS Score: {{ resume.ats_score }}%
        </span>
    </div>

    <!-- ===== SUMMARY ===== -->
    <div class="analysis-section">
        <h4>Professional Summary</h4>
        <p class="text-muted">
            {{ resume.summary if resume.summary else "No summary available." }}
        </p>
    </div>

    <!-- ===== SKILLS ===== -->
    <div class="analysis-section">
        <h4>Skills</h4>
        {% if resume.skills %}
            <div class="skill-grid">
                {% for s in resume.skills %}
                    <span class="skill-chip">{{ s }}</span>
                {% endfor %}
            </div>
        {% else %}
            <p class="text-muted">No skills detected.</p>
        {% endif %}
    </div>

    <!-- ===== EXPERIENCE ===== -->
    <div class="analysis-section">
        <h4>Experience</h4>
        {% if resume.experience %}
            <ul class="experience-list">
                {% for e in resume.experience %}
                    <li>
                        <strong>{{ e.title or "Role" }}</strong>
                        {% if e.company %} â€“ {{ e.company }}{% endif %}
                        {% if e.duration %}
                            <span class="exp-duration">({{ e.duration }})</span>
                        {% endif %}
                    </li>
                {% endfor %}
            </ul>
        {% else %}
            <p class="text-muted">No experience listed.</p>
        {% endif %}
    </div>

    <hr class="divider">

    <!-- ===== ACTIONS ===== -->
    <div class="action-bar">
        <form method="POST" action="/update-status">
            <input type="hidden" name="resume_id" value="{{ resume._id }}">
            <input type="hidden" name="status" value="shortlisted">
            <button class="btn btn-success">Shortlist</button>
        </form>

        <form method="POST" action="/update-status">
            <input type="hidden" name="resume_id" value="{{ resume._id }}">
            <input type="hidden" name="status" value="rejected">
            <button class="btn btn-danger">Reject</button>
        </form>
    </div>

</div>

<style>
    
/* ===== ANALYSIS PAGE ===== */

.analysis-card {
    background: linear-gradient(
        145deg,
        rgba(255,255,255,0.06),
        rgba(255,255,255,0.02)
    );
    backdrop-filter: blur(14px);
    border-radius: 18px;
    padding: 26px;
    box-shadow: 0 25px 55px rgba(0,0,0,0.45);
}

/* HEADER */
.analysis-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 22px;
}

.resume-title {
    font-size: 22px;
    font-weight: 700;
    color: #f8fafc;
}

.ats-badge {
    padding: 8px 14px;
    border-radius: 999px;
    font-size: 14px;
    font-weight: 700;
    background: linear-gradient(135deg, #22c55e, #16a34a);
    color: #052e16;
}

/* SECTIONS */
.analysis-section {
    margin-bottom: 26px;
}

.analysis-section h4 {
    margin-bottom: 10px;
    font-size: 16px;
    color: #c7d2fe;
}

.text-muted {
    color: #9ca3af;
    line-height: 1.6;
}

/* SKILLS */
.skill-grid {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
}

.skill-chip {
    padding: 6px 12px;
    border-radius: 999px;
    background: rgba(99,102,241,0.18);
    color: #c7d2fe;
    font-size: 13px;
    font-weight: 600;
}

/* EXPERIENCE */
.experience-list {
    padding-left: 18px;
}

.experience-list li {
    margin-bottom: 10px;
    line-height: 1.5;
}

.exp-duration {
    color: #94a3b8;
    font-size: 13px;
    margin-left: 6px;
}

/* DIVIDER */
.divider {
    border: none;
    border-top: 1px solid rgba(255,255,255,0.08);
    margin: 26px 0;
}

/* ACTION BAR */
.action-bar {
    display: flex;
    gap: 14px;
}

/* BUTTONS */
.btn {
    border: none;
    padding: 12px 22px;
    border-radius: 12px;
    font-size: 14px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.25s ease;
}

.btn-success {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    color: #052e16;
}

.btn-danger {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    color: #fff;
}

.btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 10px 24px rgba(0,0,0,0.4);
}
</style>

{% endblock %}
